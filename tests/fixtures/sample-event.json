{'version': '0', 'id': 'c9ce7ceb-e181-a8f2-3dac-5141e527114b', 'detail-type': 'Datadog Alert Notification', 'source': 'aws.partner/datadog.com/security-alerts', 'account': '671642278147', 'time': '2022-11-28T17:49:06Z', 'region': 'us-west-2', 'resources': [], 'detail': {'date_detected': 1669657744000, 'alert_type': 'error', 'last_updated': 1669657744000, 'event_type': 'api', 'date_ended': None, 'tags': ['availability-zone:us-west-2a', 'aws_autoscaling_groupname:traveldogecsstack-traveldogdefaultautoscalinggroupasg8c130cca-11pk6qdf8xv21', 'aws_cloudformation_logical-id:traveldogdefaultautoscalinggroupasg8c130cca', 'aws_cloudformation_stack-id:arn:aws:cloudformation:us-west-2:671642278147:stack/traveldogecsstack/88ff8190-649e-11ed-8dba-0648807ce39d', 'aws_cloudformation_stack-name:traveldogecsstack', 'ecs_cluster:traveldogecsstack-traveldogec2cluster6a5e1d3d-lm3c1hwpz8ei', 'iam_profile:traveldogecsstack-traveldogdefaultautoscalinggroupinstanceprofilead71d159-uek0u8yz8ohy', 'image:ami-0877c0ba43aeb297d', 'instance-type:a1.medium', 'kernel:none', 'name:traveldogecsstack/traveldogdefaultautoscalinggroup', 'region:us-west-2', 'rule_id:python_cli_code', 'security-group:sg-069c96980071b03e4', 'security:attack', 'source:runtime-security-agent', 'tactic:ta0002-execution', 'technique:t1059-command-and-scripting-interpreter', 'type:exec'], 'msg_title': '{host:i-08bf0896453370704} Python executed with suspicious arguments - python_cli_code_suspicious', 'priority': 'normal', 'source_type_name': 'Security Monitoring', 'msg_text': '%%%\n## Goal\n\nDetect Python code being provided and executed on the command line using the `-c` flag.\n\n## Strategy\n\nPython code can be specified on the command line using the `-c` flag. Attackers may use this to run "one-liners" which establish communication with an attacker-run server, download additional malware, or otherwise advance their mission. Libraries such as `socket` and `subprocess` are commonly used in these attacks and are unlikely to have a legitimate purpose when used in this way.\n\n## Triage and response\n\n1. Review the process tree and identify if the Python command is expected.\n2. If the command is not expected, contain the host or container and roll back to a known good configuration.\n3. Start the incident response process and determine the initial entry point.\n\n*Requires Agent version 7.27 or greater*\n- - - - - - - - - - - - -\n[[View Security Signal](https://app.datadoghq.com/security?event=AQAAAYS_W0oUz_a1IAAAAABBWVNfVzBvVUFBQlpSc21YeG5ZNzhnQUE&start=1669655941844&end=1669659541844)] · [[Edit Security Rule](https://app.datadoghq.com/security/configuration/rules/edit/siu-upn-9wn)] · [[Manage Notification](https://app.datadoghq.com/security/configuration/notification-profiles/edit/itf-c1u-xur)]\nThis notification was triggered by [[Critical and High Severity Signals](https://app.datadoghq.com/security/configuration/notification-profiles/edit/itf-c1u-xur)].\n@awseventbridge-security-alerts\n%%%', 'meta': {'signal': {'logs_sample': [{'content': {'status': 'info', 'service': '', 'tags': ['rule_id:python_cli_code', 'type:exec', 'source:runtime-security-agent', 'availability-zone:us-west-2a', 'aws_autoscaling_groupname:traveldogecsstack-traveldogdefaultautoscalinggroupasg8c130cca-11pk6qdf8xv21', 'aws_cloudformation_logical-id:traveldogdefaultautoscalinggroupasg8c130cca', 'aws_cloudformation_stack-id:arn:aws:cloudformation:us-west-2:671642278147:stack/traveldogecsstack/88ff8190-649e-11ed-8dba-0648807ce39d', 'aws_cloudformation_stack-name:traveldogecsstack', 'ecs_cluster:traveldogecsstack-traveldogec2cluster6a5e1d3d-lm3c1hwpz8ei', 'iam_profile:traveldogecsstack-traveldogdefaultautoscalinggroupinstanceprofilead71d159-uek0u8yz8ohy', 'image:ami-0877c0ba43aeb297d', 'instance-type:a1.medium', 'kernel:none', 'name:traveldogecsstack/traveldogdefaultautoscalinggroup', 'region:us-west-2', 'security-group:sg-069c96980071b03e4'], 'timestamp': 1669657740414, 'ingest_size_in_bytes': 34374, 'custom': {'status': 'info', 'service': '', 'title': 'Python code was provided on the command line', 'process': {'executable': {'group': 'root', 'name': 'python2.7', 'modification_time': '2022-05-25T14:31:53Z', 'change_time': '2022-10-12T18:53:46.191497929Z', 'mount_id': 41, 'gid': 0, 'mode': 33261, 'filesystem': 'xfs', 'uid': 0, 'path': '/usr/bin/python2.7', 'inode': 3148741, 'user': 'root'}, 'ancestors': [{'executable': {'group': 'root', 'name': 'bash', 'modification_time': '2020-07-15T05:58:24Z', 'change_time': '2022-10-12T18:53:39.781546088Z', 'mount_id': 41, 'gid': 0, 'mode': 33261, 'filesystem': 'xfs', 'uid': 0, 'path': '/usr/bin/bash', 'inode': 3146964, 'user': 'root'}, 'group': 'root', 'uid': 0, 'exec_time': '2022-11-28T17:48:29.067800828Z', 'pid': 21241, 'exit_time': '2022-11-28T17:48:54.033496424Z', 'is_thread': True, 'gid': 0, 'comm': 'bash', 'user': 'root', 'credentials': {'fsuid': 0, 'euser': 'root', 'egroup': 'root', 'uid': 0, 'fsgroup': 'root', 'cap_effective': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'fsgid': 0, 'group': 'root', 'cap_permitted': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'egid': 0, 'euid': 0, 'fsuser': 'root', 'gid': 0, 'user': 'root'}, 'tid': 21241, 'fork_time': '2022-11-28T17:48:54.033161576Z', 'ppid': 21126, 'tty': 'pts0'}, {'executable': {'group': 'root', 'name': 'bash', 'modification_time': '2020-07-15T05:58:24Z', 'change_time': '2022-10-12T18:53:39.781546088Z', 'mount_id': 41, 'gid': 0, 'mode': 33261, 'filesystem': 'xfs', 'uid': 0, 'path': '/usr/bin/bash', 'inode': 3146964, 'user': 'root'}, 'group': 'root', 'uid': 0, 'envs': ['TERM', 'LANG', 'MAIL', 'PATH=/sbin:/bin:/usr/sbin:/usr/bin', 'LOGNAME', 'USER', 'USERNAME', 'HOME', 'SHELL', 'SUDO_COMMAND', 'SUDO_USER', 'SUDO_UID', 'SUDO_GID', 'XDG_SESSION_ID', 'XDG_RUNTIME_DIR'], 'argv0': 'bash', 'pid': 21126, 'tty': 'pts0', 'exec_time': '2022-11-28T17:48:29.067800828Z', 'gid': 0, 'comm': 'bash', 'user': 'root', 'credentials': {'fsuid': 0, 'euser': 'root', 'egroup': 'root', 'uid': 0, 'fsgroup': 'root', 'cap_effective': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'fsgid': 0, 'group': 'root', 'cap_permitted': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'egid': 0, 'euid': 0, 'fsuser': 'root', 'gid': 0, 'user': 'root'}, 'tid': 21126, 'fork_time': '2022-11-28T17:48:29.067237574Z', 'ppid': 21125}, {'executable': {'group': 'root', 'name': 'su', 'modification_time': '2022-10-19T21:21:24Z', 'change_time': '2022-11-15T04:37:50.856028308Z', 'mount_id': 41, 'gid': 0, 'mode': 35309, 'filesystem': 'xfs', 'uid': 0, 'path': '/usr/bin/su', 'inode': 3158623, 'user': 'root'}, 'group': 'root', 'uid': 0, 'exec_time': '2022-11-28T17:48:29.051768628Z', 'pid': 21126, 'exit_time': '2022-11-28T17:48:29.067800828Z', 'is_thread': True, 'gid': 0, 'comm': 'su', 'user': 'root', 'credentials': {'fsuid': 0, 'euser': 'root', 'egroup': 'root', 'uid': 0, 'fsgroup': 'root', 'cap_effective': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'fsgid': 0, 'group': 'root', 'cap_permitted': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'egid': 0, 'euid': 0, 'fsuser': 'root', 'gid': 0, 'user': 'root'}, 'tid': 21126, 'fork_time': '2022-11-28T17:48:29.067237586Z', 'ppid': 21125, 'tty': 'pts0'}, {'executable': {'group': 'root', 'name': 'su', 'modification_time': '2022-10-19T21:21:24Z', 'change_time': '2022-11-15T04:37:50.856028308Z', 'mount_id': 41, 'gid': 0, 'mode': 35309, 'filesystem': 'xfs', 'uid': 0, 'path': '/usr/bin/su', 'inode': 3158623, 'user': 'root'}, 'group': 'root', 'uid': 0, 'envs': ['TERM', 'LANG', 'MAIL', 'PATH=/sbin:/bin:/usr/sbin:/usr/bin', 'LOGNAME', 'USER', 'USERNAME', 'HOME', 'SHELL', 'SUDO_COMMAND', 'SUDO_USER', 'SUDO_UID', 'SUDO_GID', 'XDG_SESSION_ID'], 'argv0': 'su', 'pid': 21125, 'tty': 'pts0', 'exec_time': '2022-11-28T17:48:29.051768628Z', 'gid': 0, 'comm': 'su', 'user': 'root', 'credentials': {'fsuid': 0, 'euser': 'root', 'egroup': 'root', 'uid': 0, 'fsgroup': 'root', 'cap_effective': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'fsgid': 0, 'group': 'root', 'cap_permitted': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'egid': 0, 'euid': 0, 'fsuser': 'root', 'gid': 0, 'user': 'root'}, 'tid': 21125, 'fork_time': '2022-11-28T17:48:29.051280314Z', 'ppid': 21124}, {'executable': {'group': 'root', 'name': 'sudo', 'modification_time': '2021-02-08T21:06:46Z', 'change_time': '2022-10-12T18:53:54.701433993Z', 'mount_id': 41, 'gid': 0, 'mode': 34889, 'filesystem': 'xfs', 'uid': 0, 'path': '/usr/bin/sudo', 'inode': 3178905, 'user': 'root'}, 'group': 'root', 'uid': 0, 'exec_time': '2022-11-28T17:48:29.006014182Z', 'pid': 21125, 'exit_time': '2022-11-28T17:48:29.051768628Z', 'is_thread': True, 'gid': 0, 'comm': 'sudo', 'user': 'root', 'credentials': {'fsuid': 0, 'euser': 'root', 'egroup': 'root', 'uid': 0, 'fsgroup': 'root', 'cap_effective': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'fsgid': 0, 'group': 'root', 'cap_permitted': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'egid': 0, 'euid': 0, 'fsuser': 'root', 'gid': 0, 'user': 'root'}, 'tid': 21125, 'fork_time': '2022-11-28T17:48:29.05128029Z', 'ppid': 21124, 'tty': 'pts0'}, {'executable': {'group': 'root', 'name': 'sudo', 'modification_time': '2021-02-08T21:06:46Z', 'change_time': '2022-10-12T18:53:54.701433993Z', 'mount_id': 41, 'gid': 0, 'mode': 34889, 'filesystem': 'xfs', 'uid': 0, 'path': '/usr/bin/sudo', 'inode': 3178905, 'user': 'root'}, 'args': ['su'], 'group': 'root', 'uid': 0, 'envs': ['TERM', 'PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin', 'PWD', 'LANG', 'SHLVL', 'HOME', '_'], 'argv0': 'sudo', 'pid': 21124, 'tty': 'pts0', 'exec_time': '2022-11-28T17:48:29.006014182Z', 'gid': 0, 'comm': 'sudo', 'user': 'root', 'credentials': {'fsuid': 0, 'euser': 'root', 'egroup': 'root', 'uid': 0, 'fsgroup': 'root', 'cap_effective': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'fsgid': 0, 'group': 'root', 'cap_permitted': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'egid': 0, 'euid': 0, 'fsuser': 'root', 'gid': 0, 'user': 'root'}, 'tid': 21124, 'fork_time': '2022-11-28T17:48:29.005301804Z', 'ppid': 21123}, {'executable': {'group': 'root', 'name': 'bash', 'modification_time': '2020-07-15T05:58:24Z', 'change_time': '2022-10-12T18:53:39.781546088Z', 'mount_id': 41, 'gid': 0, 'mode': 33261, 'filesystem': 'xfs', 'uid': 0, 'path': '/usr/bin/bash', 'inode': 3146964, 'user': 'root'}, 'group': 'ssm-user', 'uid': 1001, 'exec_time': '2022-11-28T17:48:23.392118894Z', 'pid': 21124, 'exit_time': '2022-11-28T17:48:29.006014182Z', 'is_thread': True, 'gid': 1001, 'comm': 'sh', 'user': 'ssm-user', 'credentials': {'fsuid': 1001, 'euser': 'ssm-user', 'egroup': 'ssm-user', 'uid': 1001, 'fsgroup': 'ssm-user', 'fsgid': 1001, 'group': 'ssm-user', 'egid': 1001, 'euid': 1001, 'fsuser': 'ssm-user', 'gid': 1001, 'user': 'ssm-user'}, 'tid': 21124, 'fork_time': '2022-11-28T17:48:29.00530178Z', 'ppid': 21123, 'tty': 'pts0'}, {'executable': {'group': 'root', 'name': 'bash', 'modification_time': '2020-07-15T05:58:24Z', 'change_time': '2022-10-12T18:53:39.781546088Z', 'mount_id': 41, 'gid': 0, 'mode': 33261, 'filesystem': 'xfs', 'uid': 0, 'path': '/usr/bin/bash', 'inode': 3146964, 'user': 'root'}, 'group': 'ssm-user', 'uid': 1001, 'envs': ['PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin', 'TERM', 'LANG', 'HOME'], 'argv0': 'sh', 'pid': 21123, 'tty': 'pts0', 'exec_time': '2022-11-28T17:48:23.392118894Z', 'gid': 1001, 'comm': 'sh', 'user': 'ssm-user', 'credentials': {'fsuid': 1001, 'euser': 'ssm-user', 'egroup': 'ssm-user', 'uid': 1001, 'fsgroup': 'ssm-user', 'fsgid': 1001, 'group': 'ssm-user', 'egid': 1001, 'euid': 1001, 'fsuser': 'ssm-user', 'gid': 1001, 'user': 'ssm-user'}, 'tid': 21123, 'fork_time': '2022-11-28T17:48:23.391723963Z', 'ppid': 21111}, {'executable': {'group': 'root', 'name': 'ssm-session-worker', 'modification_time': '2022-10-04T08:12:40Z', 'change_time': '2022-11-15T04:37:16.166020697Z', 'mount_id': 41, 'gid': 0, 'mode': 33261, 'filesystem': 'xfs', 'uid': 0, 'path': '/usr/bin/ssm-session-worker', 'inode': 3146094, 'user': 'root'}, 'group': 'ssm-user', 'uid': 1001, 'exec_time': '2022-11-28T17:48:23.213283657Z', 'pid': 21123, 'exit_time': '2022-11-28T17:48:23.392118894Z', 'is_thread': True, 'gid': 1001, 'comm': 'ssm-session-wor', 'user': 'ssm-user', 'credentials': {'fsuid': 1001, 'euser': 'ssm-user', 'egroup': 'ssm-user', 'uid': 1001, 'fsgroup': 'ssm-user', 'cap_effective': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'fsgid': 1001, 'group': 'ssm-user', 'cap_permitted': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'egid': 1001, 'euid': 1001, 'fsuser': 'ssm-user', 'gid': 1001, 'user': 'ssm-user'}, 'tid': 21123, 'fork_time': '2022-11-28T17:48:23.391723975Z', 'ppid': 21111}, {'executable': {'group': 'root', 'name': 'ssm-session-worker', 'modification_time': '2022-10-04T08:12:40Z', 'change_time': '2022-11-15T04:37:16.166020697Z', 'mount_id': 41, 'gid': 0, 'mode': 33261, 'filesystem': 'xfs', 'uid': 0, 'path': '/usr/bin/ssm-session-worker', 'inode': 3146094, 'user': 'root'}, 'args': ['root-0dc73be515007335c'], 'group': 'root', 'uid': 0, 'envs': ['PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin'], 'argv0': '/usr/bin/ssm-session-worker', 'pid': 21111, 'exec_time': '2022-11-28T17:48:23.213283657Z', 'gid': 0, 'comm': 'ssm-session-wor', 'user': 'root', 'credentials': {'fsuid': 0, 'euser': 'root', 'egroup': 'root', 'uid': 0, 'fsgroup': 'root', 'cap_effective': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'fsgid': 0, 'group': 'root', 'cap_permitted': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'egid': 0, 'euid': 0, 'fsuser': 'root', 'gid': 0, 'user': 'root'}, 'tid': 21116, 'fork_time': '2022-11-28T17:48:23.21306083Z', 'ppid': 1648}, {'executable': {'group': 'root', 'name': 'ssm-agent-worker', 'modification_time': '2022-10-04T08:12:40Z', 'change_time': '2022-11-15T04:37:12.255999995Z', 'mount_id': 41, 'gid': 0, 'mode': 33261, 'filesystem': 'xfs', 'uid': 0, 'path': '/usr/bin/ssm-agent-worker', 'inode': 3146090, 'user': 'root'}, 'group': 'root', 'uid': 0, 'exec_time': '2022-11-15T04:37:17Z', 'pid': 21111, 'exit_time': '2022-11-28T17:48:23.213283657Z', 'is_thread': True, 'gid': 0, 'comm': 'ssm-agent-worke', 'user': 'root', 'credentials': {'fsuid': 0, 'euser': 'root', 'egroup': 'root', 'uid': 0, 'fsgroup': 'root', 'cap_effective': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'fsgid': 0, 'group': 'root', 'cap_permitted': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'egid': 0, 'euid': 0, 'fsuser': 'root', 'gid': 0, 'user': 'root'}, 'tid': 21111, 'fork_time': '2022-11-28T17:48:23.213060794Z', 'ppid': 1648}, {'executable': {'group': 'root', 'name': 'ssm-agent-worker', 'modification_time': '2022-10-04T08:12:40Z', 'change_time': '2022-11-15T04:37:12.255999995Z', 'mount_id': 41, 'gid': 0, 'mode': 33261, 'filesystem': 'xfs', 'uid': 0, 'path': '/usr/bin/ssm-agent-worker', 'inode': 3146090, 'user': 'root'}, 'group': 'root', 'uid': 0, 'exec_time': '2022-11-15T04:37:17Z', 'argv0': '/usr/bin/ssm-agent-worker', 'pid': 1648, 'gid': 0, 'comm': 'ssm-agent-worke', 'user': 'root', 'credentials': {'fsuid': 0, 'euser': 'root', 'egroup': 'root', 'uid': 0, 'fsgroup': 'root', 'cap_effective': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'fsgid': 0, 'group': 'root', 'cap_permitted': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'egid': 0, 'euid': 0, 'fsuser': 'root', 'gid': 0, 'user': 'root'}, 'tid': 1648, 'fork_time': '2022-11-15T04:37:17Z', 'ppid': 1596}, {'executable': {'group': 'root', 'name': 'amazon-ssm-agent', 'modification_time': '2022-10-04T08:12:40Z', 'change_time': '2022-11-15T04:37:10.416018315Z', 'mount_id': 41, 'gid': 0, 'mode': 33261, 'filesystem': 'xfs', 'uid': 0, 'path': '/usr/bin/amazon-ssm-agent', 'inode': 3146106, 'user': 'root'}, 'group': 'root', 'uid': 0, 'exec_time': '2022-11-15T04:37:16Z', 'argv0': '/usr/bin/amazon-ssm-agent', 'pid': 1596, 'gid': 0, 'comm': 'amazon-ssm-agen', 'user': 'root', 'credentials': {'fsuid': 0, 'euser': 'root', 'egroup': 'root', 'uid': 0, 'fsgroup': 'root', 'cap_effective': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'fsgid': 0, 'group': 'root', 'cap_permitted': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'egid': 0, 'euid': 0, 'fsuser': 'root', 'gid': 0, 'user': 'root'}, 'tid': 1596, 'fork_time': '2022-11-15T04:37:16Z', 'ppid': 1}, {'executable': {'group': 'root', 'name': 'systemd', 'modification_time': '2022-09-28T02:18:47Z', 'change_time': '2022-10-12T18:53:52.021454128Z', 'mount_id': 41, 'gid': 0, 'mode': 33261, 'filesystem': 'xfs', 'uid': 0, 'path': '/usr/lib/systemd/systemd', 'inode': 2145945, 'user': 'root'}, 'args': ['--switched-root', '--system', '--deserialize', '21'], 'group': 'root', 'uid': 0, 'exec_time': '2022-11-15T04:36:10Z', 'argv0': '/usr/lib/systemd/systemd', 'pid': 1, 'gid': 0, 'comm': 'systemd', 'user': 'root', 'credentials': {'fsuid': 0, 'euser': 'root', 'egroup': 'root', 'uid': 0, 'fsgroup': 'root', 'cap_effective': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'fsgid': 0, 'group': 'root', 'cap_permitted': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'egid': 0, 'euid': 0, 'fsuser': 'root', 'gid': 0, 'user': 'root'}, 'tid': 1, 'fork_time': '2022-11-15T04:36:10Z'}], 'group': 'root', 'uid': 0, 'parent': {'executable': {'group': 'root', 'name': 'bash', 'modification_time': '2020-07-15T05:58:24Z', 'change_time': '2022-10-12T18:53:39.781546088Z', 'mount_id': 41, 'gid': 0, 'mode': 33261, 'filesystem': 'xfs', 'uid': 0, 'path': '/usr/bin/bash', 'inode': 3146964, 'user': 'root'}, 'group': 'root', 'uid': 0, 'exec_time': '2022-11-28T17:48:29.067800828Z', 'pid': 21241, 'exit_time': '2022-11-28T17:48:54.033496424Z', 'is_thread': True, 'gid': 0, 'comm': 'bash', 'user': 'root', 'credentials': {'fsuid': 0, 'euser': 'root', 'egroup': 'root', 'uid': 0, 'fsgroup': 'root', 'cap_effective': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'fsgid': 0, 'group': 'root', 'cap_permitted': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'egid': 0, 'euid': 0, 'fsuser': 'root', 'gid': 0, 'user': 'root'}, 'tid': 21241, 'fork_time': '2022-11-28T17:48:54.033161576Z', 'ppid': 21126, 'tty': 'pts0'}, 'envs': ['XDG_SESSION_ID', 'SHELL', 'TERM', 'USER'], 'args': ['-c', 'SOCK_STREAM'], 'argv0': 'python', 'pid': 21241, 'exec_time': '2022-11-28T17:48:54.033496424Z', 'gid': 0, 'comm': 'python', 'user': 'root', 'credentials': {'fsuid': 0, 'euser': 'root', 'egroup': 'root', 'uid': 0, 'fsgroup': 'root', 'cap_effective': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'fsgid': 0, 'group': 'root', 'cap_permitted': ['CAP_AUDIT_CONTROL', 'CAP_AUDIT_READ', 'CAP_AUDIT_WRITE', 'CAP_BLOCK_SUSPEND', 'CAP_CHOWN', 'CAP_DAC_OVERRIDE', 'CAP_DAC_READ_SEARCH', 'CAP_FOWNER', 'CAP_FSETID', 'CAP_IPC_LOCK', 'CAP_IPC_OWNER', 'CAP_KILL', 'CAP_LEASE', 'CAP_LINUX_IMMUTABLE', 'CAP_MAC_ADMIN', 'CAP_MAC_OVERRIDE', 'CAP_MKNOD', 'CAP_NET_ADMIN', 'CAP_NET_BIND_SERVICE', 'CAP_NET_BROADCAST', 'CAP_NET_RAW', 'CAP_SETFCAP', 'CAP_SETGID', 'CAP_SETPCAP', 'CAP_SETUID', 'CAP_SYSLOG', 'CAP_SYS_ADMIN', 'CAP_SYS_BOOT', 'CAP_SYS_CHROOT', 'CAP_SYS_MODULE', 'CAP_SYS_NICE', 'CAP_SYS_PACCT', 'CAP_SYS_PTRACE', 'CAP_SYS_RAWIO', 'CAP_SYS_RESOURCE', 'CAP_SYS_TIME', 'CAP_SYS_TTY_CONFIG', 'CAP_WAKE_ALARM'], 'egid': 0, 'euid': 0, 'fsuser': 'root', 'gid': 0, 'user': 'root'}, 'tid': 21241, 'fork_time': '2022-11-28T17:48:54.033161576Z', 'ppid': 21126}, 'timestamp': 1669657740414, 'hostname': 'i-08bf0896453370704', 'agent': {'rule_id': 'python_cli_code', 'version': '7.40.1', 'policy_version': '1.7.1', 'policy_name': 'default.policy'}, 'usr': {'group': 'root', 'id': 'root'}, 'file': {'group': 'root', 'name': 'python2.7', 'modification_time': '2022-05-25T14:31:53Z', 'change_time': '2022-10-12T18:53:46.191497929Z', 'mount_id': 41, 'gid': 0, 'mode': 33261, 'filesystem': 'xfs', 'uid': 0, 'path': '/usr/bin/python2.7', 'inode': 3148741, 'user': 'root'}, 'date': '2022-11-28T17:48:54.033925867Z', 'evt': {'category': 'Process Activity', 'outcome': 'Success', 'name': 'exec'}}, 'source': 'runtime-security-agent', 'host': 'i-08bf0896453370704', 'tiebreaker': 2137558039, 'host_id': 9215136777}, 'eventId': 'AQAAAYS_W0R-f2iMFwAAAABBWVNfVzBvVUFBQWhxWjlTZU1wTkpRQUE', 'trackKey': {'orgId': 420797, 'type': 'logs'}, 'queryIndex': 0, 'id': 'AYS_W0oUAAAhqZ9SeMpNJQAA'}], 'severity': 'high', 'title': 'Python executed with suspicious arguments - python_cli_code_suspicious', 'rule': {'group_by_fields': {'host': 'i-08bf0896453370704'}, 'type': 'workload_security', 'name': 'Python executed with suspicious arguments', 'matched_queries': ['@agent.rule_id:python_cli_code @process.args:(*SOCK_STREAM* OR *subprocess* OR *\\/bash* OR *\\/bin\\/sh*  OR *pty.spawn*)'], 'id': 'siu-upn-9wn'}, 'is_secure_org': False, 'msg': '## Goal\n\nDetect Python code being provided and executed on the command line using the `-c` flag.\n\n## Strategy\n\nPython code can be specified on the command line using the `-c` flag. Attackers may use this to run "one-liners" which establish communication with an attacker-run server, download additional malware, or otherwise advance their mission. Libraries such as `socket` and `subprocess` are commonly used in these attacks and are unlikely to have a legitimate purpose when used in this way.\n\n## Triage and response\n\n1. Review the process tree and identify if the Python command is expected.\n2. If the command is not expected, contain the host or container and roll back to a known good configuration.\n3. Start the incident response process and determine the initial entry point.\n\n*Requires Agent version 7.27 or greater*', 'attributes': {'host': 'i-08bf0896453370704', 'service': '', 'custom': {'service': '', 'title': 'Python code was provided on the command line', 'process': {'executable': {'path': '/usr/bin/python2.7', 'name': 'python2.7'}, 'args': ['-c', 'SOCK_STREAM'], 'parent': {'executable': {'path': '/usr/bin/bash', 'name': 'bash'}}}, 'timestamp': -1084537730, 'agent': {'rule_id': 'python_cli_code'}, 'usr': {'id': 'root'}, 'file': {'path': '/usr/bin/python2.7', 'name': 'python2.7'}, 'evt': {'category': 'Process Activity', 'outcome': 'Success', 'name': 'exec'}}}, 'id': 'AQAAAYS_W0oUz_a1IAAAAABBWVNfVzBvVUFBQlpSc21YeG5ZNzhnQUE'}, 'result': {'logs_url': '/security?event=AQAAAYS_W0oUz_a1IAAAAABBWVNfVzBvVUFBQlpSc21YeG5ZNzhnQUE&start=1669655941844&end=1669659541844'}, 'group_by_values': {'host': 'i-08bf0896453370704'}}, 'aggregate_event_id': None, 'date': 1669657744000, 'id': '6801397461799540621'}}
